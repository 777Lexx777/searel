{
  "name": "${matches(request.uri.path, '^/ui/rb/nnn/errr')}",
  "condition": "${matches(request.uri.path, '^/ui/rb/nnn/errr')}",
  "monitor": true,
  "timer": true,
  "handler": {
    "type": "Chain",
    "config": {
      "filters": [
        {
          "type": "HeaderFilter",
          "config": {
            "messageType": "REQUEST",
            "remove": ["Host"],
            "add": {
              "Host" :["${matchingGroups(system['nnn.errr.ui'],\"https:\/\/(.[^\/]*)\")[2]}"]
            }
          }
        },
        {
          "type": "ScriptableFilter",
          "config": {
            "type": "application/x-groovy",
            "file": "policyAdvice.groovy",
            "args": {
              "advices": [
                {"realm": "/staff",			"action": "Войти", "service": "oauth2token"},
                {"realm": "/staff",			"action": "Войти", "service": "default"}
              ]
            }
          }
        }
      ],
      "handler": {
        "type": "DispatchHandler",
        "config": {
          "bindings": [
            {
              "handler": "ClientHandler",
              "capture": "all",
              "baseURI": "${system['nnn.errr.ui']}"
            }
          ]
        }
      }
    }
  }
}